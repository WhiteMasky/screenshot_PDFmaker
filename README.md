# screenshot_PDFmaker
Automatically take screenshots and convert them to one PDF in a sudden

# 循环点击截图生成PDF工具

一个基于PyQt5的自动化截图工具，可以循环点击指定位置并截图，最终生成PDF文档。特别适用于需要批量截取网页、应用程序界面的场景。

## ✨ 主要功能

- 🔄 **循环点击**：自动循环使用预设的点击位置，直到达到指定次数
- 📸 **智能截图**：支持多种截图模式（全屏、智能窗口、指定区域等）
- 🖱️ **防遮挡**：点击后自动移动鼠标，避免浮标遮挡截图内容
- 📄 **PDF生成**：支持多种布局（单页单图、双图上下排列、双图左右排列）
- ⚙️ **高度可配置**：点击间隔、截图区域、循环次数等均可自定义
- 🚀 **自动化**：支持完成后自动生成PDF并退出程序

## 🚀 Quick Start

### 环境要求

- Python 3.7+
- macOS / Windows / Linux

### 安装依赖

```bash
# 基础依赖（所有系统）
pip install PyQt5 pyautogui pillow reportlab
```

### 运行程序

```bash
python pdf.py
```

## 📖 使用指南

### 1. 基础设置

1. **选择截图模式**：
   - `智能窗口截图`：自动截取屏幕中央80%区域（推荐）
   - `全屏截图`：截取整个屏幕
   - `顶部内容截图`：截取屏幕上方70%区域
   - `指定区域截图`：手动设置截图区域

2. **配置参数**：
   - `点击间隔`：每次点击后的等待时间（建议3-5秒）
   - `总点击次数`：程序将执行的总点击次数
   - `移动鼠标`：避免浮标遮挡（建议开启）

### 2. 添加点击位置

1. **方法一**：将鼠标移动到目标位置，点击"添加当前鼠标位置"
2. **方法二**：点击"手动添加位置"，输入具体坐标

### 3. 选择PDF布局

- `每页一张图片`：传统布局，图片较大
- `每页两张图片(上下排列-竖向纸张)`：节省纸张，适合横向截图
- `每页两张图片(左右排列-横向纸张)`：节省纸张，适合竖向截图

### 4. 开始执行

1. 点击"测试截图"确认截图效果
2. 点击"开始循环点击截图"
3. 程序将按设置循环执行点击和截图
4. 完成后可手动或自动生成PDF

## 🎯 使用场景

### 网页翻页截图
```
设置示例：
- 点击位置：下一页按钮
- 总点击次数：20
- 点击间隔：3秒
- PDF布局：上下排列
```

### 应用程序界面截图
```
设置示例：
- 点击位置：菜单项、按钮等
- 截图模式：智能窗口截图
- 移动鼠标：开启（避免悬停效果）
```

### 幻灯片截图
```
设置示例：
- 点击位置：下一页键
- PDF布局：每页一张图片
- 点击间隔：2秒
```

## 📁 文件结构

程序运行后会创建以下目录：

```
项目目录/
├── screenshots/          # 截图文件存储
├── test_screenshots/     # 测试截图存储
├── auto_output_*.pdf     # 自动生成的PDF
└── screenshot_tool.py    # 主程序文件
```

## ⚙️ 高级配置

### 循环逻辑说明

假设你添加了3个点击位置，设置总点击次数为10：

```
第1轮：位置1 → 位置2 → 位置3 (第1-3次)
第2轮：位置1 → 位置2 → 位置3 (第4-6次)  
第3轮：位置1 → 位置2 → 位置3 (第7-9次)
第4轮：位置1 (第10次)
```

### PDF布局对比

| 布局模式 | 纸张方向 | 适用场景 | 节省程度 |
|---------|---------|---------|---------|
| 每页一张 | 竖向 | 需要查看细节 | 标准 |
| 上下排列 | 竖向 | 横向截图（网页等） | 节省50% |
| 左右排列 | 横向 | 竖向截图（手机界面等） | 节省50% |

## 🔧 故障排除

### 常见问题

1. **截图区域不正确**
   - 使用"测试截图"功能预览效果
   - 尝试"智能窗口截图"模式
   - 手动调整截图区域参数

2. **点击位置不准确**
   - 确保目标窗口在前台
   - 检查屏幕缩放设置
   - 使用"添加当前鼠标位置"功能

3. **程序运行缓慢**
   - 适当增加点击间隔
   - 关闭不必要的后台程序
   - 检查截图区域大小

4. **PDF生成失败**
   - 确保有足够的磁盘空间
   - 检查截图文件是否正常生成
   - 尝试手动生成PDF

### 权限问题

**macOS**：
```bash
# 需要在系统偏好设置中授予辅助功能权限
系统偏好设置 → 安全性与隐私 → 隐私 → 辅助功能
```

**Windows**：
```bash
# 可能需要以管理员身份运行
右键程序 → 以管理员身份运行
```

## 📝 更新日志

### v1.0.0
- ✅ 基础循环点击截图功能
- ✅ 多种截图模式支持
- ✅ 智能鼠标移动防遮挡
- ✅ 多种PDF布局选项
- ✅ 自动化执行支持

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个工具！

## 📄 许可证

MIT License

---

**提示**：首次使用建议先用较少的点击次数进行测试，确认所有设置正确后再进行大批量操作。
